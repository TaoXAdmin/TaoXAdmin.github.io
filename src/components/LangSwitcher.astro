---
const SUPPORTED = ['fr', 'en', 'de', 'pt'] as const;
type Lang = typeof SUPPORTED[number];

interface Props {
  current?: Lang;      // prop principale
  currentLang?: Lang;  // alias pour compatibilitÃ© (Header utilise cette prop)
  path?: string;       // e.g. Astro.url.pathname
}

const {
  current: currentProp,
  currentLang: currentLangProp,
  path = Astro.url.pathname,
} = Astro.props as Props;

const current: Lang = (currentProp ?? currentLangProp ?? 'fr') as Lang;

function switchPath(lang: Lang): string {
  const parts = path.split('/');
  parts[1] = lang; // /fr/... -> /en/...
  const candidate = parts.join('/');
  return candidate.startsWith('/') ? candidate : `/${candidate}`;
}
---
<nav aria-label="Language switcher" class="flex gap-2 text-sm">
  {SUPPORTED.map((l) => (
    <a
      href={switchPath(l)}
      aria-current={l === current ? 'page' : undefined}
      class={`px-2 py-1 rounded ${
        l === current ? 'bg-blue-600 text-white' : 'hover:bg-neutral-100 dark:hover:bg-neutral-800'
      }`}
    >
      {l.toUpperCase()}
    </a>
  ))}
</nav>
