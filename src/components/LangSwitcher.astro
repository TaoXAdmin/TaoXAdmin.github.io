---
const SUPPORTED = ['fr', 'en', 'de', 'pt'] as const;
type Lang = typeof SUPPORTED[number];

interface Props {
  current?: Lang;
  currentLang?: Lang;
  path?: string;
}

const {
  current: currentProp,
  currentLang: currentLangProp,
  path = Astro.url.pathname,
} = Astro.props as Props;

const current: Lang = (currentProp ?? currentLangProp ?? 'fr') as Lang;

function switchPath(lang: Lang): string {
  const parts = path.split('/');
  parts[1] = lang; // /fr/... -> /en/...
  const candidate = parts.join('/');
  return candidate.startsWith('/') ? candidate : `/${candidate}`;
}
---
<nav aria-label="Language switcher" class="flex gap-2 text-sm text-white">
  {SUPPORTED.map((l) => (
    <a
      href={switchPath(l)}
      aria-current={l === current ? 'page' : undefined}
      class={`inline-flex items-center justify-center rounded-lg px-2.5 py-1
              font-medium border transition
              focus:outline-none focus-visible:ring-2 focus-visible:ring-[#D6B36A40]
              ${l === current
                ? 'text-white border-[#D6B36A80] bg-[#D6B36A14] shadow-[inset_0_0_0_1px_rgba(214,179,106,.25)]'
                : 'text-white/80 border-white/10 hover:text-[#D6B36A] hover:border-[#D6B36A66] hover:bg-white/5 active:bg-white/10'}`}
    >
      {l.toUpperCase()}
    </a>
  ))}
</nav>
